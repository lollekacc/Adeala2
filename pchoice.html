<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Adeala – Välj belöning</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="assets/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
</head>

<body class="font-[Inter] bg-white min-h-screen">

  <!-- HEADER -->
  <div id="header-placeholder"></div>

  <!-- MAIN CONTENT -->
  <!-- (your <main> stays here) -->

  <!-- FOOTER -->
  <div id="footer-placeholder"></div>
<script>
document.addEventListener("DOMContentLoaded", async () => {
  document.getElementById("header-placeholder").innerHTML =
    await fetch("partials/header.html").then(r => r.text());

  document.getElementById("footer-placeholder").innerHTML =
    await fetch("partials/footer.html").then(r => r.text());
});
</script>

</body>
</html>

<main class="max-w-6xl mx-auto px-6 py-16">

  <h1 class="text-4xl font-bold text-center mb-4">Välj dina belöningar</h1>
  <p class="text-center text-gray-600 mb-12">
    Fördela din belöning mellan våra samarbetspartners (minst 100 kr per val).
  </p>

  <!-- Calculator -->
  <div class="bg-white rounded-2xl p-6 mb-12 flex justify-between items-center shadow border">
    <div>
      <p class="text-sm text-gray-600">Totalt belöningsvärde</p>
      <p class="text-xl font-bold"><span id="totalReward">0</span> kr</p>
    </div>
    <div>
      <p class="text-sm text-gray-600">Valt hittills</p>
      <p class="text-xl font-bold text-[#0C4A3C]">
        <span id="selectedSum">0</span> kr
      </p>
    </div>
    <div>
      <p class="text-sm text-gray-600">Återstår</p>
      <p class="text-xl font-bold text-red-600">
        <span id="remainingSum">0</span> kr
      </p>
    </div>
  </div>

  <!-- Rewards -->
  <div id="rewardGrid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8"></div>

  <!-- Continue -->
  <button
    id="continueBtn"
    disabled
    class="mt-12 w-full adeala-btn py-5 text-lg rounded-xl opacity-50 cursor-not-allowed">
    Fortsätt
  </button>

</main>
<script>
/* -----------------------------
   DATA (same companies as belöning.html)
----------------------------- */
const rewards = [
  { company: "ICA Maxi", logo: "https://detailproduktion.se/wp-content/uploads/2014/04/ica-maxi-stormarknad-logo.png"},
  { company: "Amazon", logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Amazon_logo.svg/1280px-Amazon_logo.svg.png"},
  { company: "MIO", logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/6/6e/MIO_Logo.svg/2560px-MIO_Logo.svg.png"},
  { company: "Coop", logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/d/d4/Coop_logo.svg/2560px-Coop_logo.svg.png"},
  { company: "H&M", logo: "https://upload.wikimedia.org/wikipedia/commons/5/53/H%26M-Logo.svg"},
  { company: "MQ", logo: "https://www.kungsmassan.se/Images/Butiker/MQMARQET_1080x1080.png"},
  { company: "Guldfynd", logo: "https://www.datocms-assets.com/138720/1732112442-guldfynd.png?auto=format&fit=max&w=1200"},
  { company: "Hemtex", logo: "https://images.seeklogo.com/logo-png/32/1/hemtex-logo-png_seeklogo-329500.png"},
  { company: "Hemköp", logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/c/ce/Hemkop_logo.svg/1280px-Hemkop_logo.svg.png"},
  { company: "Specsavers", logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/7/78/Specsavers_logo.svg/1200px-Specsavers_logo.svg.png"},
  { company: "Synsam", logo: "https://kraftenifinspang.se/wp-content/uploads/2024/09/Loggor-centrumbutikerna_Synsam-1024x503.png"},
  { company: "SATS", logo: "https://cdn.sanity.io/images/xkmfhygb/production/7a8c8bd647ab4949343baef3fe30dc92281489e7-1920x1080.jpg?w=1200&h=630&fit=crop&crop=focalpoint"}
];

/* -----------------------------
   TOTAL REWARD
----------------------------- */
const stored = JSON.parse(localStorage.getItem("rewardChoice"));
const TOTAL_REWARD = stored?.reward ? Number(stored.reward) : 1000;

/* -----------------------------
   ELEMENTS
----------------------------- */
const grid = document.getElementById("rewardGrid");
const selectedEl = document.getElementById("selectedSum");
const remainingEl = document.getElementById("remainingSum");
const totalEl = document.getElementById("totalReward");
const continueBtn = document.getElementById("continueBtn");

totalEl.textContent = TOTAL_REWARD;

/* -----------------------------
   STATE
----------------------------- */
const selections = {};

/* -----------------------------
   RENDER
----------------------------- */
rewards.forEach(r => {
  const card = document.createElement("div");
  card.className = "reward-card flex flex-col gap-4";

  card.innerHTML = `
    <img src="${r.logo}" class="h-12 mb-4 object-contain">
    <h3 class="font-semibold text-lg mb-2">${r.company}</h3>

    <input
      type="number"
      min="0"
      step="100"
      placeholder="0"
      class="reward-input border rounded-xl p-3 w-full"
      data-company="${r.company}">
  `;

  grid.appendChild(card);
});

/* -----------------------------
   CALCULATION
----------------------------- */
document.querySelectorAll(".reward-input").forEach(input => {
  input.addEventListener("input", () => {
    const company = input.dataset.company;
    const value = Number(input.value) || 0;

    if (value > 0 && value < 100) {
      input.classList.add("border-red-500");
      selections[company] = 0;
    } else {
      input.classList.remove("border-red-500");
      selections[company] = value;
    }

    updateTotals();
  });
});

function updateTotals() {
  const selected = Object.values(selections).reduce((a, b) => a + b, 0);
  const remaining = TOTAL_REWARD - selected;

  selectedEl.textContent = selected;
  remainingEl.textContent = remaining;

  const valid =
    remaining === 0 &&
    Object.values(selections).every(v => v === 0 || v >= 100);

  continueBtn.disabled = !valid;
  continueBtn.classList.toggle("opacity-50", !valid);
  continueBtn.classList.toggle("cursor-not-allowed", !valid);
}

/* -----------------------------
   CONTINUE
----------------------------- */
continueBtn.addEventListener("click", () => {
  localStorage.setItem("rewardDistribution", JSON.stringify(selections));
  window.location.href = "signera.html";
});
</script>
